{% load static %}
<!DOCTYPE html>
<html>
<head>
  <title>Products</title>
</head>
<body>

<h2>All Products</h2>

<form method="get">
  <input type="text" name="q" placeholder="Search..." value="{{ request.GET.q }}">
  <button type="submit">Search</button>
</form>

<hr>

<div style="display:grid; grid-template-columns: repeat(3, 1fr); gap: 18px;">
  {% for p in products %}
    <div style="border:1px solid #eee; padding:12px; border-radius:10px;">
      <div style="height:220px; display:flex; align-items:center; justify-content:center; overflow:hidden;">
        {% if p.image %}
          <img src="{{ p.image.url }}" alt="{{ p.name }}" style="max-width:100%; max-height:100%;">
        {% else %}
          <img src="{% static 'img/placeholder.svg' %}" alt="No image" style="max-width:100%; max-height:100%;">
        {% endif %}
      </div>

      <h3 style="margin:10px 0 4px;">{{ p.name }}</h3>
      <div>{{ p.brand.name }} • {{ p.category.name }}</div>
      <div style="margin-top:8px;"><b>₹{{ p.price }}</b></div>

      <div style="margin-top:8px;">
        {% if p.stock_quantity|default:0 > 0 %}
          In stock: {{ p.stock_quantity }}
        {% else %}
          Out of stock
        {% endif %}
      </div>

      <div style="margin-top:10px;">
        <a href="{% url 'product_detail' p.id %}">View</a>
      </div>
    </div>
  {% empty %}
    <p>No products found.</p>
  {% endfor %}
</div>

</body>
</html>
