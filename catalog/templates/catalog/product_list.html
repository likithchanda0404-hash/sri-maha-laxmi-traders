{% extends "core/base.html" %}
{% load static %}
{% block title %}Products • Sri Maha Laxmi Traders{% endblock %}

{% block content %}
<div class="section-title">
  <div>
    <h2>All Products</h2>
    <p>Browse products brand-wise</p>
  </div>
</div>

<form class="searchbar" method="get" action="{% url 'product_list' %}">
  <input type="text" name="q" value="{{ q }}" placeholder="Search products…" />
  <button type="submit">Search</button>
  {% if q %}
    <a class="pill" href="{% url 'product_list' %}">Clear</a>
  {% endif %}
</form>

<div style="height:12px;"></div>

<div class="grid">
  {% for p in products %}
    <a class="card item" href="{% url 'product_detail' p.id %}">
      <div class="imgbox">
        {% if p.image %}
          <img src="{{ p.image.url }}" alt="{{ p.name }}">
        {% else %}
          <img src="{% static 'img/placeholder.png' %}" alt="{{ p.name }}">
        {% endif %}
      </div>

      <h3>{{ p.name }}</h3>
      <div class="muted">{{ p.brand.name }} • {{ p.category.name }}</div>

      <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
        <div class="price">₹{{ p.price }}</div>
        {% if p.stock_quantity <= 0 %}
          <span class="stock"><span class="dot low"></span>Out of stock</span>
        {% elif p.stock_quantity <= 5 %}
          <span class="stock"><span class="dot low"></span>Low: {{ p.stock_quantity }}</span>
        {% else %}
          <span class="stock"><span class="dot"></span>In stock: {{ p.stock_quantity }}</span>
        {% endif %}
      </div>
    </a>
  {% empty %}
    <div class="card item">
      <h3>No products found</h3>
      <p class="muted">Try a different keyword.</p>
    </div>
  {% endfor %}
</div>
{% endblock %}
